# ADR: 現段階ではページ削除を ARCHIVE 状態で運用する

- 日付: 2026-02-09
- ステータス: 採用
- 関連要件: `docs/requirements.md` の「ページ/セグメント」「翻訳」「翻訳の投票」「Premium（課金: Polar）」

## 背景

- 本サービスは、ページ本文をセグメント単位で翻訳・投票する体験が中核になっている。
- 表示・翻訳・投票は `contents`/`segments` を前提に同じ経路で組み立てられている。
- この段階で物理削除や別テーブル移送を導入すると、通常ページと削除ページで実装経路が分岐しやすい。
- 有料記事は購入後の閲覧継続が前提になるため、購入者向け表示を壊さない運用が必要になる。

## 問題

- `deleted_pages` に移送して `contents`/`segments` を落とすと、既存の表示・投票前提を崩しやすい。
- 仕様が固まる前に削除専用経路を増やすと、運用コストとバグ混入リスクが増える。
- 有料記事で購入実績がある場合、閲覧継続要件と削除操作の整合を取りづらくなる。

## 判断

- 現段階では `page_status` の `ARCHIVE` を維持し、削除相当の状態として扱う。
- `ARCHIVE` は公開導線（一覧/検索/公開ページ）から除外する。
- `contents`/`segments`/翻訳関連データは保持し、将来仕様変更に備える。
- 有料記事（購入実績あり）は購入者向け表示を継続する前提とし、物理削除の対象にしない。
- 本当に物理削除が必要になった時点で、別途 ADR を作成して移行方針を決める。

## 代替案

1. `deleted_pages` に移送して物理削除する
   - メリット: 公開テーブルを軽く保てる。
   - デメリット: 表示経路が分岐し、セグメント前提機能との整合が難しくなる。

2. `deleted_at` カラム方式に統一する
   - メリット: 状態表現が明確で拡張しやすい。
   - デメリット: 既存実装との差分が増えるため、現段階では変更コストが高い。

## 影響

- ページ取得系クエリは `ARCHIVE` の除外条件を維持する必要がある。
- 復帰は `ARCHIVE` 解除で完結でき、データ再生成は不要。
- 有料記事は「表示継続」を守るため、販売停止と削除を分離して運用する必要がある。
- 将来、削除ポリシーを厳密化する場合は `requirements` と合わせて再判断する。

## 実装メモ（任意）

- 現行仕様の整理が進んだ段階で、`ARCHIVE` 維持の是非を再評価する。
